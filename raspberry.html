<html lang="es">
<head>
  	<meta charset="utf-8">
  	<title>Samuel Roa Raspberry Pi</title>
  	<meta name="viewport" content="width=device-width, initial-scale=1.0">
  	<meta name="description" content="">
  	<meta name="author" content="">

		
	<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" rel="stylesheet">
<link href="style.css" rel="stylesheet">

	<script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js"
	integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
	crossorigin="anonymous"></script>
	<script type="text/javascript" src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="scripts.js"></script>
	
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
    <link type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1/themes/redmond/jquery-ui.css" rel="stylesheet" />
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1/jquery-ui.min.js"></script>
    <script type="text/javascript" src="jquery.youtubepopup.min.js"></script>

    <script type="text/javascript">
		$(function () {
			
			$("a.youtube").YouTubePopup({ idAttribute: 'youtube' });
		});
    </script>
	
</head>

<body>

<div class="container">
	
	<div class="row clearfix">
	
		<div class="col-md-10 column">
			<div class="jumbotron">
				<h1>
					Raspberry Pi
				</h1>
				<p>
					Proyecto de Electronica
				</p>
				
				<p>
					<a class="btn btn-primary btn-large" href="robotica.html">Robotica</a>
				</p>
			</div>
			
		</div>
		
	</div>		
	
	<div class="row clearfix">
	
		<div class="col-md-12 column">
			
				<div class="tabbable" id="tabs-100039">

					<ul class="nav nav-tabs">
						<li class="active">
							<a href="#panel-761307" data-toggle="tab"><h3>Circuitos </h3></a>
						</li>
						<li>
							<a href="#panel-113341" data-toggle="tab"><h3>Estructuras </h3></a>
						</li>
						<li>
							<a href="#panel-113343" data-toggle="tab"><h3>Talleres </h3></a>
						</li>
						<li>
							<a href="#panel-511" data-toggle="tab"><h3>Proyectos </h3></a>
						</li>
					</ul>
					
					<div class="tab-content">
				
						<div class="tab-pane active" id="panel-761307">


							<p>
								Con la herramienta Fritzing, se puede disenar circuitos electronicos de forma visual y amigable.
							</p>

							<div class="row">
						
								<div class="col-md-10">
									<div class="thumbnail">
										<h3>
											Conector GPIO (Pines) Raspberry Pi B+
										</h3>
										
											<p>
												Con esta herramienta, se puede disenr un circuito electronico de forma visual y amigable. En este grafico, se documenta, como se construyo el circuito de una oruga tamiya, para controlar los motores, usando un integrado L293D
											</p>

										<div class="caption">
										
											<p>
												Circuito del controlador de motor L298N, con un Raspberry Pi B+, y bluetooh. Montado sobre un tractor
											</p>
											
										</div>
										
										<img src="images/diagramas/raspberry_gpio_connector.jpg">
									</div>
								
								</div>

							</div>
	
							<div class="row">
							
								<div class="col-md-10">
									<div class="thumbnail">
													
										<div class="caption">
										
											<h2>
												Circuito del controlador de motor L298N, con un Raspberry Pi B+, y bluetooh. Montado sobre un tractor
											</h2>
										
										</div>
										
										<img witdh="400" height="400" src="images/diagramas/Taller_RaspberryPi_Bluetooh_bb.png">
							
									</div>
							
								</div>
							
							</div>
	
							<div class="row">
								<div class="col-md-10">
									<div class="thumbnail">
										
										<div class="caption">
										
											<h2>
												Proyecto Robot con Piloto Autonomo 
											</h2>
											<p>
												Oruga tamiya, para controlar los motores, usando un L298N, Sensor Ultrasonico HC-SR04 en Servomotor, para que pueda sensar obstaculos y controlar movimiento sin intervencion humana				
											</p>
											
										</div>
										
										<img witdh="500" height="400" src="images/diagramas/Proyecto_RaspberryPi_L298N_Servo_HC-SR04_LM2596_bb.png">
										
									</div>
									
								</div>
							</div>



						</div>
							
						<div class="tab-pane" id="panel-113341">

							<p>
								Detalle fotografico de la estructura de una Oruga Tamiya.
							</p>
							
							<div class="col-md-12 column">

								<div class="jumbotron">
									<h1>
										Construccion de la Oruga
									</h1>
									<p>
										Secuencia de construccion de la oruga
									</p>
									
								</div>

							</div>

							<div class="row clearfix">

								<div class="col-md-12 column">

									<div class="carousel slide" id="carousel-350989">
									
										<ol class="carousel-indicators">
											<li class="active" data-slide-to="0" data-target="#carousel-350989">
											</li>
											<li data-slide-to="1" data-target="#carousel-350989">
											</li>
											<li data-slide-to="2" data-target="#carousel-350989">
											</li>
										</ol>

										<div class="carousel-inner">

											<div class="item active">

												<img witdh="500" height="400" src="images/carro//DSCN2394.JPG" />

												<div class="carousel-caption">
													<h4>
														Vista Superior
													</h4>
													<p>
														Estructura en balso que contiene el motor GearBox doble y el controlador L298N, esta estructura soporta la plataforma superior
													</p>
												</div>

											</div>
											
											<div class="item">
											
												<img witdh="500" height="400" src="images/carro/DSCN2396.JPG" />
											
												<div class="carousel-caption">
													<h4>
														Vista Lateral
													</h4>
													<p>
														Estructura en balso que contiene el motor GearBox doble y el controlador L298N, esta estructura soporta la plataforma superior
													</p>
												</div>

											</div>
											
											<div class="item">

												<img witdh="500" height="400" src="images/carro/DSCN2399.JPG" />

												<div class="carousel-caption">
													<h4>
														Vista Superior
													</h4>
													<p>
														Plataforma Superior
													</p>
												</div>

											</div>
											
											<div class="item">

												<img witdh="500" height="400" src="images/carro/DSCN2399.JPG" />
											
												<div class="carousel-caption">
													<h4>
														Vista Lateral
													</h4>
													<p>
														Oruga con Estructura en balso que contiene el motor GearBox doble y el controlador L298N y la plataforma superior
													</p>
												</div>

											</div>
											
											<div class="item">

												<img witdh="500" height="400" src="images/carro/DSCN2404.JPG" />

												<div class="carousel-caption">
													<h4>
														Vista Frontal
													</h4>
													<p>
														Oruga con Estructura en balso que contiene el motor GearBox doble y el controlador L298N y la plataforma superior con dispositivos como bateria, Sensor Ultrasonico HC-SR04 con Servo, Raspberry y Bluetooh
													</p>
												</div>

											</div>
											
											<div class="item">

												<img witdh="500" height="400" src="images/carro/DSCN2405.JPG" />

												<div class="carousel-caption">
													<h4>
														Vista Angular
													</h4>
													<p>
														Oruga con Estructura en balso que contiene el motor GearBox doble y el controlador L298N y la plataforma superior con dispositivos como bateria, Sensor Ultrasonico HC-SR04 con Servo, Raspberry y Bluetooh
													</p>
												</div>

											</div>
											
											<div class="item">

												<img witdh="500" height="400" src="images/carro/DSCN2406.JPG" />

												<div class="carousel-caption">
													<h4>
														Vista Angular
													</h4>
													<p>
														Oruga con Estructura en balso que contiene el motor GearBox doble y el controlador L298N y la plataforma superior con dispositivos como bateria, Sensor Ultrasonico HC-SR04 con Servo, Raspberry y Bluetooh
													</p>
												</div>

											</div>
											
											<div class="item">

												<img witdh="500" height="400" src="images/carro/DSCN2408.JPG" />

												<div class="carousel-caption">
													<h4>
														Vista Frontal
													</h4>
													<p>
														Oruga con Estructura en balso que contiene el motor GearBox doble y el controlador L298N y la plataforma superior con dispositivos como bateria, Sensor Ultrasonico HC-SR04 con Servo, Raspberry y Bluetooh
													</p>
												</div>

											</div>
											
											<div class="item">

												<img witdh="500" height="400" src="images/carro/DSCN2409.JPG" />

												<div class="carousel-caption">
													<h4>
														Vista Laterial
													</h4>
													<p>
														Oruga con Estructura en balso que contiene el motor GearBox doble y el controlador L298N y la plataforma superior con dispositivos como bateria, Sensor Ultrasonico HC-SR04 con Servo, Raspberry y Bluetooh
													</p>
												</div>

											</div>
											
										</div> <a class="left carousel-control" href="#carousel-350989" data-slide="prev"><span class="glyphicon glyphicon-chevron-left"></span></a> <a class="right carousel-control" href="#carousel-350989" data-slide="next"><span class="glyphicon glyphicon-chevron-right"></span></a>
									
									</div>

								</div> 	
							
							</div>
													
						</div>
						
						<div class="tab-pane" id="panel-113343">
					
							
							<div class="row">
							
								<div class="col-md-10">
								
									<div class="thumbnail">
								
										<h2>
											Taller 1 Control de Motores
										</h2>
										
										<p>
											Controlando motores Gearbox con un L298N.
										</p>

										<div class="caption">
										
											<p>
												Circuito en Fritzing
											</p>
											
										</div>

										<img witdh="500" height="400" src="images/diagramas/Taller_RaspberryPi_L298N_motores_bb.png">
										
										<div class="caption">
										
											<p>
												Vista
											</p>
											
										</div>

										<img witdh="400" height="400" src="images/carro/DSCN2394.JPG">
										
										<div class="caption">
										
											<p>
												Video
											</p>
											
										</div>
										
										<div id="videos223">

											<object width="640" height="360">
											  <param name="movie" value="https://www.youtube.com/v/pCpDw2AtCZI"></param>
											  <param name="allowFullScreen" value="true"></param>
											  <param name="allowScriptAccess" value="always"></param>
											  <embed src="https://www.youtube.com/v/pCpDw2AtCZI" type="application/x-shockwave-flash" allowfullscreen="true" allowScriptAccess="always" width="640" height="360"></embed>
											 
											</object>

										</div>
										
										<p>
											Script en Python
										</p>
										<pre>
										<code>
import RPi.GPIO as gpio
import time

gpio.setwarnings(False)
gpio.setmode(gpio.BCM)

ENA = 12
ENB = 18
IN1 = 4
IN2 =17
IN3 =27
IN4 =22
VELN =20

gpio.setup(ENA,gpio.OUT)
gpio.setup(ENB,gpio.OUT)
gpio.setup(IN1,gpio.OUT)
gpio.setup(IN2,gpio.OUT)
gpio.setup(IN3,gpio.OUT)
gpio.setup(IN4,gpio.OUT)

def atras():

    gpio.output(IN1,True)
    gpio.output(IN2,False)
    gpio.output(IN3,True)
    gpio.output(IN4,False)

def adelante():
    gpio.output(IN1,False)
    gpio.output(IN2,True)
    gpio.output(IN3,False)
    gpio.output(IN4,True)

def derecha():
    gpio.output(IN1,False)
    gpio.output(IN2,False)
    gpio.output(IN3,False)
    gpio.output(IN4,True)


def izquierda():
    gpio.output(IN1,False)
    gpio.output(IN2,True)
    gpio.output(IN3,False)
    gpio.output(IN4,False)

def parar():
    gpio.output(IN1,False)
    gpio.output(IN2,False)
    gpio.output(IN3,False)
    gpio.output(IN4,False)

gpio.output(ENA,True)
gpio.output(ENB,True)

pwma = gpio.PWM(ENA,VELN)
pwmb = gpio.PWM(ENB,VELN)

pwma.start(VELN)
pwmb.start(VELN)

try:

    while True:
        pwma.ChangeDutyCycle(VELN)
        pwmb.ChangeDutyCycle(VELN)
        adelante()
        time.sleep(2)
##        atras()
##        time.sleep(2)
        parar()
        time.sleep(3)
        pwma.ChangeDutyCycle(VELN + 10)
        pwmb.ChangeDutyCycle(VELN + 10)
        atras()
        time.sleep(3)
        pwma.ChangeDutyCycle(10)
        pwmb.ChangeDutyCycle(10)
        derecha()
        time.sleep(3)
        izquierda()
        time.sleep(3)

except KeyboardInterrupt:
    pwma.stop()
    pwmb.stop()
    gpio.cleanup()										
										</code>
										</pre>
											
									</div>
									
								</div>								
								
							</div>
							
							
														<div class="row">
						
								<div class="col-md-10">
	
									<div class="thumbnail">
									
										<h2>
											Taller 2 Sensor Ultrasonico
										</h2>
										
										<p>
											Calculando Distancia con un Sensor HC-SR04
										</p>

										<div class="caption">
										
											<p>
												Raspberry Pi y un Sensor de Ultrasonido HC-SR04
											</p>
											
										</div>
										
										<img witdh="400" height="400" src="images/diagramas/Taller_RaspberryPi_HC-SR04_bb.png">
										
										<div class="caption">
										
											<p>
												Vista
											</p>
											
										</div>
	
										<img witdh="400" height="400" src="images/carro/DSCN2431.JPG">
										
										<div id="Tallervideos1">
	
											<object width="640" height="360">
											  <param name="movie" value="https://www.youtube.com/v/80AXXQvD1QA"></param>
											  <param name="allowFullScreen" value="true"></param>
											  <param name="allowScriptAccess" value="always"></param>
											  <embed src="https://www.youtube.com/v/80AXXQvD1QA" type="application/x-shockwave-flash" allowfullscreen="true" allowScriptAccess="always" width="640" height="360"></embed>
											 
											</object>

										</div>
									
										<div class="col-md-12 column">

											<h2>
											  Codigo Python
											</h2>

											<pre>
											<code>
import RPi.GPIO as GPIO
import time

GPIO.setwarnings(False)
GPIO.setmode(GPIO.BCM)

GPIO_TRIGGER = 25
GPIO_ECHO = 7

GPIO.setup(GPIO_TRIGGER,GPIO.OUT)
GPIO.setup(GPIO_ECHO,GPIO.IN)

GPIO.output(GPIO_TRIGGER,False)

try:
	 while True:
		GPIO.output(GPIO_TRIGGER,True)
		time.sleep(0.00001)
		GPIO.output(GPIO_TRIGGER,False)
		start = time.time()
		
		while GPIO.input(GPIO_ECHO)==0:
				start =time.time()
				
		while GPIO.input(GPIO_ECHO)==1:
				start =time.time()

		elapsed = stop-start
		distance=(elapsed * 34300)/2

		print "Distancia " + str(round(distance,2)) + " cms"

		time.sleep(1)

except KeyboardInterrupt:
		print "Salir"
		GPIO.cleanup()
											</code>
											</pre>

										</div>

									</div>

								</div>
								
							</div>		

							<div class="row">
						
								<div class="col-md-10">

									<div class="thumbnail">
								
										<h2>
											Taller 3 Servomotor
										</h2>
											
										<p>
											Programar Movimientos del Servomotor en 3 direcciones
										</p>

										<div class="caption">
											
											<p>
												Raspberry Pi y un Servomotor, se programa movimientos en 3 direcciones Derecha, Izquierda y Centro, en Python
											</p>
										</div>		
										<img witdh="500" height="400" src="images/diagramas/Taller_RaspberryPi_servo_bb.png">
											
										<img witdh="500" height="400" src="images/carro/DSCN2405.JPG">
									
										Posicionamiento del microservo para obtener lecturas
										
										<div id="Tallervideos3">

											<object width="640" height="360">
											  <param name="movie" value="https://www.youtube.com/v/raz-BIZJHVw"></param>
											  <param name="allowFullScreen" value="true"></param>
											  <param name="allowScriptAccess" value="always"></param>
											  <embed src="https://www.youtube.com/v/raz-BIZJHVw" type="application/x-shockwave-flash" allowfullscreen="true" allowScriptAccess="always" width="640" height="360"></embed>
											 
											</object>

										</div>
										
										<div class="col-md-12 column">
										
											<h2>
											  Codigo Python
											</h2>

											<pre>
											<code>
import RPi.GPIO as GPIO
import time

GPIO.setwarnings(False)
GPIO.setmode(GPIO.BCM)
GPIO.setup(21,GPIO.OUT)

p = GPIO.PWM(21,50)
p.start(6)

try:
	 while True:
		p.ChangeDutyCycle(3)        #Posicion Derecha
		time.sleep(0.5)
		p.ChangeDutyCycle(10)       #Posicion Izquierda
     	time.sleep(0.5)
		p.ChangeDutyCycle(6)        #Posicion Centro
		time.sleep(0.5)
		
except KeyboardInterrupt:
		p.stop()
		GPIO.cleanup()

											</code>
											</pre>

										</div>

									</div>
									
								</div>
								
							</div>			
							
													<div class="row">
							
								<div class="col-md-10">

									<div class="thumbnail">
								
										<h2>
											Taller 4 LEDs
										</h2>
										
											<p>
												Programar encendido y apagado de Leds
											</p>

										<div class="caption">
										
											<p>
												Raspberry Pi y un circuito con Leds, se programa con C Sharp
											</p>
											
										</div>
										
										<img witdh="500" height="400" src="images/diagramas/Taller_RaspberryPi_Led_bb.png">
										
										<img witdh="500" height="400" src="images/carro/DSCN2408.JPG">
								
								
										Prender y apagar LEDs
										
										<div id="videosTaller4">
									
											<object width="640" height="360">
											  <param name="movie" value="https://www.youtube.com/v/raz-BIZJHVw"></param>
											  <param name="allowFullScreen" value="true"></param>
											  <param name="allowScriptAccess" value="always"></param>
											  <embed src="https://www.youtube.com/v/raz-BIZJHVw" type="application/x-shockwave-flash" allowfullscreen="true" allowScriptAccess="always" width="640" height="360"></embed>
											 
											</object>
									
										</div>
										
										<p>Codigo C Sharp:</p>

										<pre>
										<code>
using System;
using Raspberry.IO.GeneralPurpose;
using Raspberry.IO.GeneralPurpose.Behaviors;

namespace led

{
	public class pi
	{
		public pi ()
		{
			var led1 = ConnectorPin.P1Pin7.Output();

			var conexion = new GpioConnection(led1);

			for (var i=0;i==100;i++)
			{

				conexion.Toggle(led1);
				System.Threading.Thread.Sleep(250);

			}

			conexion.Close();
		}
	}
}
											   
										</code>
										</pre>
									
									</div>
								
								</div>
							
							</div>
							
													<div class="row">
							
								<div class="col-md-10">

									<div class="thumbnail">
								
										<h2>
											Taller 5 Camara PiNoir
										</h2>
										
										<p>
											Programar captura de fotos y video
										</p>

										<div class="caption">
										
											<p>
												Raspberry Pi y camara PiNoir con Python
											</p>
											
										</div>
										
										<img witdh="500" height="400" src="images/diagramas/Taller_RaspberryPi_Camara_bb.png">
										
										<img witdh="500" height="400" src="images/carro/DSCN2408.JPG">

									
										Capturar Video
										
										<div id="Tallervideos5">

											<object width="640" height="360">
											  <param name="movie" value="https://www.youtube.com/v/raz-BIZJHVw"></param>
											  <param name="allowFullScreen" value="true"></param>
											  <param name="allowScriptAccess" value="always"></param>
											  <embed src="https://www.youtube.com/v/raz-BIZJHVw" type="application/x-shockwave-flash" allowfullscreen="true" allowScriptAccess="always" width="640" height="360"></embed>
											 
											</object>

										</div>
										
										<h2>
										  Codigo Python
										</h2>

									</div>
									
								</div>

							</div>
							
							
						</div>	

						<div class="tab-pane" id="panel-511">
							
								<div class="row">
							
									<div class="col-md-10">

										<div class="thumbnail">
											<h1>
												Oruga controlada remotamente via Bluetooh
											</h1>
											
											<p>
												La Oruga se controla via bluetooh, desde cualquier dispositivo ya sea una tablet o un Smartphone.
											</p>

											<div class="caption">
											
												<p>
													Es una oruga tamiya, se controla los motores, usando un integrado L298N, una Raspberry Pi y un bluetooh HC-06.
												</p>
												
											</div>
											
											<img witdh="500" height="400" src="images/carro/raspberrypi.jpg">

										</div>

									</div>

								</div>
								
								<div class="row">
							
									<div class="col-md-10">

										<div class="thumbnail">
											<h1>
												Oruga con Control Autonomo
											</h1>
											
											<p>
												La Oruga se desplaza de forma autonoma, sin intervencion de humano, usando un Sensor de Ultrasonido, el cual le indica cual es la ruta a seguir, de acuerdo al programa en Python que se escribe para ello.
											</p>

										</div>
										
										<div class="caption">
										
										
										</div>
										
										<img width="500" height="400" src="images/carro/DSCN2404.JPG">
										<img width="500" height="400" src="images/carro/DSCN2409.JPG">
										
	<div class="row clearfix">
		<div class="col-md-10 column">
			<div class="carousel slide" id="carousel-350999">
				<ol class="carousel-indicators">
					<li class="active" data-slide-to="0" data-target="#carousel-350999">
					</li>
					<li data-slide-to="1" data-target="#carousel-350999">
					</li>
					<li data-slide-to="2" data-target="#carousel-350999">
					</li>
					<li data-slide-to="3" data-target="#carousel-350999">
					</li>
					<li data-slide-to="4" data-target="#carousel-350999">
					</li>
					<li data-slide-to="5" data-target="#carousel-350999">
					</li>
				</ol>
					<div class="item active">
						<img alt="" width="500" height="400" src="images/carro/P1050829.JPG" />
						<div class="carousel-caption">
							<h4>
								
							</h4>
							<p>
								
							</p>
						</div>
					</div>
					<div class="item">
						<img alt="" width="500" height="400" src="images/carro/P1050830.JPG" />
						<div class="carousel-caption">
							<h4>
								
							</h4>
							<p>
								
							</p>
						</div>
					</div>
					<div class="item">
						<img alt="" width="500" height="400" src="images/carro/P1050831.JPG" />
						<div class="carousel-caption">
							<h4>
								
							</h4>
							<p>
								
							</p>
						</div>
					</div>
					<div class="item">
						<img alt="" width="500" height="400" src="images/carro/P1050832.JPG" />
						<div class="carousel-caption">
							<h4>
								
							</h4>
							<p>
								
							</p>
						</div>
					</div>
					<div class="item">
						<img width="500" height="400" src="images/carro/P1050833.JPG" />
						<div class="carousel-caption">
							<h4>
								
							</h4>
							<p>
								
							</p>
						</div>
					</div>
				</div> <a class="left carousel-control" href="#carousel-350999" data-slide="prev"><span class="glyphicon glyphicon-chevron-left"></span></a> <a class="right carousel-control" href="#carousel-350999" data-slide="next"><span class="glyphicon glyphicon-chevron-right"></span></a>
			</div>
		</div>
	</div>
										
										<h2>
										  Componentes
										</h2>
										<ul>
											<li>Raspberry Pi 2 B+</li>
											<li>Controlador de Motor L298N</li>
											<li>MicroServo HC-06</li>
											<li>Sensor Ultrasonico HC-SR04</li>
											<li>Conversor LM2596</li>
											<li>Regleta Universal para pines adicionales</li>
											<li>Bateria LIPO</li>
											<li>Oruga Tamiya</li>
											<li>Cables</li>
										</ul>
										
										<h2>
										  Codigo Python
										</h2>
										
										<pre>
										<code>
			
	#Programa: robot_autonomo

	#Lenguaje: Python 2.0/3.0

	#Descripcion: 

	#Algoritmo que permite a un vehiculo con Raspberry Pi B+, desplazarse en forma
	#autonoma, sin intervencion alguna, evitar obstaculos y decidir su propia ruta o
	#trayectoria, opcionalmente puede disponer de camara para transmitir en linea video
	#de su avance. Toda la informacion de navegacion y control es almacenada en MySQL.
	#Ademas puede enviar emails o mensajes de texto, para informa sobre el
	#estado del Sistema.

	#Autor: Samuel y Rory

	#Fecha: 21/05/2015

	#Hardware: 
	#Raspberry Pi B+  / L298N / HC-SR04 / MicroServo / Oruga Tamiya GearBox / Camara PiNoir


	###########
	#Librerias
	###########

	import RPi.GPIO as GPIO
	import MySQLdb
	import time
	import picamera
	import smtplib
	from email.mime.text import MIMEText

	GPIO.setmode(GPIO.BCM)
	GPIO.setwarnings(False)


	################
	#Variables GPIO
	################
	#Controlan al L298N

	ENA = 12
	ENB = 18
	IN1 = 4
	IN2 = 17
	IN3 = 27
	IN4 = 22

	#Controla el MicroServo

	pinServo = 21

	#Controla el Sensor Ultrasonico HC-SR04

	pinTrig = 23
	pinEcho = 24


	######################
	#Variables de Control
	######################

	spd = 0							#Almacena la velocidad actual
	tiempo = 0						#Controla el tiempo de desplazamiento, Es continuo (-1)
	forb = 0						#Controla el sentido de desplazamiento, adelante (1) / atras (-1)
	giroservo = [0,1,2]				#Controla la direccion de giro del servomotor, Izq (0) / 
									#Centro (1) / Der (2)
	standing = 0					#Controla si el vehiculo esta detenido (0) o en movimiento (1),
									#si esta detenido debe ver en todas las direcciones
	wentback = 0                    #Controla si previamente hubo movimiento hacia atras, (0/1)
	brokentrack = 20				#Controla si la via esta en mal estado
	global connMy					#Instancia para conexion a MySQL


	############
	#Constantes
	############

	speedMax = 100					#El rango es de (0 a 100) con PWM 
	speedReduce = 25				#Variable que deduce la velocidad, para girar a los lados
									# o atras
	turnTime = 5					#Tiempo tope en segundos para moverse a los lados o atras
	stopDistance = 20				#Distancia minima, para evitar colision.

	db_host = "localhost"			#Almacena el servidor, usuario y base de datos en MySQL
	db_user = "root"				
	db_pass = "admin"
	db_name = "raspberry"

	mail_gmail = "rpi@gmail.com" 	#Almacena los datos de conexion a Gmail por smtp
	pass_gmail = "raspberry"
	mail_to = "rpi@gmail.com"

	##########################
	#Configuracion de Devices
	##########################

	#Sensor HC-SR04
	GPIO.setup(pinTrig, GPIO.OUT)
	GPIO.setup(pinEcho, GPIO.IN)

	#MicroServo
	GPIO.setup(pinServo, GPIO.OUT)

	#L298N Controlador de Motores
	GPIO.setup(ENA, GPIO.OUT)
	GPIO.setup(ENB, GPIO.OUT)
	GPIO.setup(IN1, GPIO.OUT)
	GPIO.setup(IN2, GPIO.OUT)
	GPIO.setup(IN3, GPIO.OUT)
	GPIO.setup(IN4, GPIO.OUT)


	###########
	#Funciones
	###########

	#Para Desplazamiento

	def stop():

		spd = 0
		forb = 0
		tiempo = 0
		standing = 1
		GPIO.output (ENA, False)
		GPIO.output (ENB, False)

	def goForward(fast):

		offset = brokenTrack

		if fast = 1:
			offset = speedMax

		pwma = GPIO.PWM(ENA, offset)
		pwmb = GPIO.PWM(ENB, offset)

		pwma.start(offset)
		pwmb.start(offset)
		pwma.ChangeDutyCycle(offset)
		pwmb.ChangeDutyCycle(offset)

		GPIO.output (IN1, False)
		GPIO.output (IN2, True)
		GPIO.output (IN3, False)
		GPIO.output (IN4, True)

		standing = 0
		forb = 1
		tiempo = -1


	def goBackward():

		offset = speedMax - speedReduce

		pwma = GPIO.PWM(ENA, offset)
		pwmb = GPIO.PWM(ENB, offset)

		pwma.start(offset)
		pwmb.start(offset)

		GPIO.output (IN1, True)
		GPIO.output (IN2, False)
		GPIO.output (IN3, True)
		GPIO.output (IN4, False)

		standing = 0
		forb = -1
		tiempo = 2 * turntime
		wentback = 1


	def goLeft():

		tiempo = turntime
		
		offset = speedMax - speedReduce
		spd = offset

		pwma = GPIO.PWM(ENA, offset)
		pwmb = GPIO.PWM(ENB, offset)

		pwma.start(offset)
		pwmb.start(offset)

		GPIO.output (IN1, False)
		GPIO.output (IN2, True)
		GPIO.output (IN3, False)
		GPIO.output (IN4, False)


	def goRigth():

		tiempo = turntime
		offset = speedMax - speedReduce
		spd = offset

		pwma = GPIO.PWM(ENA, offset)
		pwmb = GPIO.PWM(ENB, offset)

		pwma.start(offset)
		pwmb.start(offset)

		GPIO.output (IN1, False)
		GPIO.output (IN2, False)
		GPIO.output (IN3, False)
		GPIO.output (IN4, True)


	#Para MicroServo

	def waitforServo():

		t = 10

		while t:
			time.sleep(50)
			t = t - 1



	def lookAtHead():

		p = GPIO.PWM(pinServo,50)
		p.ChangeDutyCycle(10)					#Se posiciona a la Izquierda

		giroservo[0] = getDistance()			#Obtiene Lectura

		p.start(6)								#Se posiciona al Centro
		waitforServo()

		giroservo[1] = getDistance()			#Obtiene Lectura

		p.start(3)								#Se posiciona a la Derecha
		waitforServo()

		giroservo[2] = getDistance()			#Obtiene Lectura

		p.start(6)								#Regresa al Centro
		waitforServo()


	#Para Sensor Ultrasonico HC-SR04

	def getDistance():

		global distance

		time.sleep(0.3)
		signaloff = 0
		signalon = 0

		GPIO.output(pinTrig, True)

		time.sleep(0.00001)
		GPIO.output(pinTrig, False)

		while GPIO.input(pinEcho) == 0:
			signaloff = time.time()

		while GPIO.input(pinEcho) == 1:
			signalon = time.time()

		timepassed = signalon - signaloff

		distance = timepassed * 17000

		return getDistance                      #Retorna Distancia en cms


	#Para MySQL

	def connMy():
		datos = [db_host, db_user, db_pass, db_name]
		connMy = MySQLdb.connect(*datos)


	def run_query(query):
		cursor = conMy.cursor()
		cursor.Execute(query)

		if query.upper().startswith("SELECT"):
			data = cursor.fetchall()
		else:
			connMy.commit()
			data = None

		cursor.close()
		conMy.close()
		return data


	#Para VideoCamara

	def getFoto():
		with picamera.Picamera() as camera:
			camera.resolution(1024, 768)
			camera.start_preview()
			camera.image_effect = none
			time.sleep(10)
			camera.image_effect = 'sketch'
			time.sleep(10)
			camera.image_effect = 'emboss'
			time.sleep(10)

	def getVideo():
		with picamera.Picamera() as camera:
			camera.resolution(640, 480)
			camera.start_preview()
			camera.start_recording('videorpi.h264')
			camera.wait_recording(60)
			camera.stop_recording()
			camera.stop_preview()



	#Para Email

	def email():

		msg = MIMEText("Cuerpo del mensaje")
		msg['Subject'] = "Asunto del mensaje"
		msg['From'] = "rpi@gmail.com"
		msg['To'] = mail_to

		server = smtplib.SMTP("smtp.gmail.com:587")
		server.ehlo_or_helo_if_needed()
		server.starttls()
		server.ehlo_or_helo_if_needed()
		server.login(user_gmail, pass_gmail)
		server.sendmail(user_gmail, mail_to, msg.as_string())
		server.quit()


	#Para Logica

	def moving():

		GPIO.output(ENA, True)
		GPIO.output(ENB, True)

		#Evalua la orientacion del avance

		if wenback = 2:

			chooseLoR()
			return

		if giroservo[0] > stopDistance:

			if giroservo[2] > stopDistance:

				if giroservo[1] >= 4 * stopDistance:

					spd = speedMax
					goForward()

				elif giroservo[1] < 4 * stopDistance && giroservo[1] > stopDistance:
				
					spd = speedMax / 2
					goForward()

				else:
				
					stop()
					lookAtHead()
					chooseLoR()

			else:
		
				goLeft()

		elif giroservo[2] > stopDistance:

			goRigth()

		else:
		
			spd = speedMax - speedReduce
			goBackward()

			giroservo[1] = getDistance	


		

	def chooseLoR():

		if giroservo[0] > stopDistance:

			if giroservo[2] > stopDistance:

				if giroservo[1] > giroservo[2]:

					goLeft()

				else:
					goRigth()

			else:
			
				goLeft()

		else:
		
			if giroservo[2] > stopDistance:

				goRigth()

			else:
			
				spd = speedMax - speedReduce

				goBackward()



	def canBackup():
		pass


	##################
	#Algoritmo Logico
	##################


	while True:

		if standing = 1:
			lookAtHead()
			Moving()

		if tiempo != 0:

			#Hay una accion de movimiento actualmente
		
			if forb = 1:
				moving()
			elif forb = -1:

				if !CanBackup():
					stop()

			tiempo = tiempo - 1

		else:
			stop()

		time.sleeop(800)
										

										</pre></code>

										<h2>
										  Video
									</h2>
										
									</div>

								</div>
								
								<div class="row">
							
									<div class="col-md-10">
										<div class="thumbnail">
											<h1>
												Oruga Autonoma con Camara
											</h1>
											
											<p>
												La Oruga se por si sola, desde cualquier dispositivo ya sea una tablet o un Smartphone, que puede transmitir video en Linea de lo observado en la ruta.
											</p>

											<div class="caption">
											
										<h2>
										  Componentes
										</h2>
										<ul>
											<li>Raspberry Pi 2 B+</li>
											<li>Controlador de Motor L298N</li>
											<li>MicroServo HC-06</li>
											<li>Sensor Ultrasonico HC-SR04</li>
											<li>Conversor LM2596</li>
											<li>Camara PiNoir HD</li>
											<li>Regleta Universal para pines adicionales</li>
											<li>Bateria LIPO</li>
											<li>Oruga Tamiya</li>
											<li>Cables</li>
										</ul>
										
										<h2>
										  Codigo Python
										</h2>
												
											</div>
											
											<img witdh="400" height="400" src="images/diagramas/RaspberryPi_L298N_Servo_HC-SR04_LM2596_bb.png">
		
										</div>
										
										<h2>
										  Video
										</h2>
		
									</div>

								</div>
								
								<div class="row">
							
									<div class="col-md-10">
										<div class="thumbnail">
											<h1>
												QuadCoptero
											</h1>
											
											<p>
												Se pretende armar un Quadcoptero controlado por Radio Control, que tenga una camara de HD con almacenamiento SD.
											</p>

											<div class="caption">
											
											<h2>
												Componentes
											</h2>
											<ul>
												<li>Controladora con acelerometro y Giroscopio</li>
												<li>4 Controladores de Motor</li>
												<li>4 Motores</li>
												<li>Camara HD con memoria SD</li>
												<li>Receptor y Transmisor de Radio</li>
												<li>Bluetooh HC-06</li>
												<li>Receptor y transmisor de Video</li>
												<li>Display para Video</li>
												<li>Radio Control con telemetria</li>
												<li>Microcontrolador Arduino</li>
												<li>Bateria LIPO</li>
												<li>Cables</li>
											</ul>

												
											</div>
											
											<img width="450" height="450" src="images/general/quadcopter_newframe.jpg">
		
										</div>
		
									</div>

								</div>

						</div>



					</div>
				
				</div>	

		</div>
	
	</div>

</div>

</body>

</html>
